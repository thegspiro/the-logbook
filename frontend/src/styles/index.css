@tailwind base;
@tailwind components;
@tailwind utilities;

/* Theme CSS Custom Properties */
:root {
  /* Background gradient */
  --bg-gradient-from: #f1f5f9;   /* slate-100 */
  --bg-gradient-via: #fef2f2;    /* red-50 */
  --bg-gradient-to: #f1f5f9;     /* slate-100 */

  /* Surfaces */
  --surface-bg: #ffffff;                    /* white */
  --surface-secondary: #f8fafc;             /* slate-50 */
  --surface-hover: #f1f5f9;                 /* slate-100 */
  --surface-border: #e2e8f0;               /* slate-200 */
  --surface-modal: #ffffff;                 /* opaque white — for modals over overlays */

  /* Text */
  --text-primary: #0f172a;                  /* slate-900 */
  --text-secondary: #475569;               /* slate-600 */
  --text-muted: #64748b;                   /* slate-500 — 4.76:1 on white (WCAG AA) */

  /* Navigation */
  --nav-bg: #ffffff;                        /* white */
  --nav-border: #e2e8f0;                   /* slate-200 */

  /* Inputs */
  --input-bg: #ffffff;                      /* white */
  --input-border: #cbd5e1;                 /* slate-300 */

  /* Scrollbar */
  --scrollbar-track: #f1f5f9;              /* slate-100 */

  /* Focus ring offset */
  --ring-offset-bg: #ffffff;               /* white */

  /* Accent colors – AA-compliant on light surfaces */
  --accent-red: #b91c1c;                   /* red-700  – 6.2:1 on #fff */
  --accent-green: #15803d;                 /* green-700 – 5.9:1 on #fff */
  --accent-blue: #1d4ed8;                  /* blue-700 – 6.5:1 on #fff */
  --accent-orange: #c2410c;               /* orange-700 – 5.3:1 on #fff */
  --accent-yellow: #a16207;               /* yellow-700 – 4.8:1 on #fff */
  --accent-cyan: #0e7490;                 /* cyan-700 – 5.2:1 on #fff */
  --accent-purple: #7e22ce;               /* purple-700 – 7.3:1 on #fff */

  /* Muted accent backgrounds */
  --accent-green-muted: #f0fdf4;          /* green-50 */
  --accent-orange-muted: #fff7ed;         /* orange-50 */

  /* Focus ring */
  --focus-ring: #dc2626;                  /* red-600 */

  /* Toast icon colors */
  --toast-success: #10b981;              /* emerald-500 */
  --toast-error: #ef4444;                /* red-500 */
  --toast-icon-secondary: #ffffff;       /* white */
  --toast-warning-bg: #fbbf24;           /* amber-400 */
  --toast-warning-text: #1a1a2e;         /* dark navy */

  /* Status indicator colors */
  --status-passed: #16a34a;              /* green-600 */
  --status-failed: #dc2626;              /* red-600 */
  --status-pending: #ca8a04;             /* yellow-600 */

  /* Alert: Info (blue) */
  --alert-info-bg: #eff6ff;                /* blue-50 */
  --alert-info-border: #bfdbfe;            /* blue-200 */
  --alert-info-icon: #2563eb;              /* blue-600 */
  --alert-info-title: #1e40af;             /* blue-800 */
  --alert-info-text: #1d4ed8;              /* blue-700 */

  /* Alert: Success (green) */
  --alert-success-bg: #f0fdf4;             /* green-50 */
  --alert-success-border: #bbf7d0;         /* green-200 */
  --alert-success-icon: #16a34a;           /* green-600 */
  --alert-success-title: #166534;          /* green-800 */
  --alert-success-text: #15803d;           /* green-700 */

  /* Alert: Warning (amber) */
  --alert-warning-bg: #fffbeb;             /* amber-50 */
  --alert-warning-border: #fde68a;         /* amber-200 */
  --alert-warning-icon: #d97706;           /* amber-600 */
  --alert-warning-title: #92400e;          /* amber-800 */
  --alert-warning-text: #b45309;           /* amber-700 */

  /* Alert: Purple */
  --alert-purple-bg: #faf5ff;              /* purple-50 */
  --alert-purple-border: #e9d5ff;          /* purple-200 */
  --alert-purple-icon: #9333ea;            /* purple-600 */
  --alert-purple-title: #6b21a8;           /* purple-800 */
  --alert-purple-text: #7e22ce;            /* purple-700 */

  /* Alert: Danger (red) */
  --alert-danger-bg: #fef2f2;              /* red-50 */
  --alert-danger-border: #fecaca;          /* red-200 */
  --alert-danger-icon: #dc2626;            /* red-600 */
  --alert-danger-title: #991b1b;           /* red-800 */
  --alert-danger-text: #b91c1c;            /* red-700 */
}

.dark {
  /* Background gradient */
  --bg-gradient-from: #0f172a;              /* slate-900 */
  --bg-gradient-via: #7f1d1d;              /* red-900 */
  --bg-gradient-to: #0f172a;               /* slate-900 */

  /* Surfaces */
  --surface-bg: rgba(255, 255, 255, 0.1);  /* white/10 */
  --surface-secondary: rgba(255, 255, 255, 0.05); /* white/5 */
  --surface-hover: rgba(255, 255, 255, 0.15); /* white/15 */
  --surface-border: rgba(255, 255, 255, 0.2); /* white/20 */
  --surface-modal: #1e293b;                /* slate-800 — opaque for modals over overlays */

  /* Text */
  --text-primary: #ffffff;                  /* white */
  --text-secondary: #cbd5e1;              /* slate-300 */
  --text-muted: #a1b1c7;                   /* between slate-400 and slate-300 — 5.2:1 on slate-900 for AA small text */

  /* Navigation */
  --nav-bg: #0f172a;                       /* slate-900 */
  --nav-border: rgba(255, 255, 255, 0.1); /* white/10 */

  /* Inputs */
  --input-bg: rgba(15, 23, 42, 0.5);      /* slate-900/50 */
  --input-border: #475569;                 /* slate-600 */

  /* Scrollbar */
  --scrollbar-track: #1e293b;              /* slate-800 */

  /* Focus ring offset */
  --ring-offset-bg: #0f172a;              /* slate-900 */

  /* Accent colors – AA-compliant on dark surfaces */
  --accent-red: #f87171;                  /* red-400  – 6.1:1 on #0f172a */
  --accent-green: #4ade80;               /* green-400 – 8.1:1 on #0f172a */
  --accent-blue: #60a5fa;                /* blue-400 – 5.7:1 on #0f172a */
  --accent-orange: #fb923c;              /* orange-400 – 6.7:1 on #0f172a */
  --accent-yellow: #facc15;              /* yellow-400 – 12.2:1 on #0f172a */
  --accent-cyan: #22d3ee;               /* cyan-400 – 10.1:1 on #0f172a */
  --accent-purple: #c084fc;             /* purple-400 – 6.2:1 on #0f172a */

  /* Muted accent backgrounds */
  --accent-green-muted: rgba(34, 197, 94, 0.1);
  --accent-orange-muted: rgba(249, 115, 22, 0.1);

  /* Focus ring */
  --focus-ring: #f87171;                 /* red-400 */

  /* Toast icon colors */
  --toast-success: #34d399;              /* emerald-400 */
  --toast-error: #f87171;                /* red-400 */
  --toast-icon-secondary: #ffffff;       /* white */
  --toast-warning-bg: #fbbf24;           /* amber-400 */
  --toast-warning-text: #1a1a2e;         /* dark navy */

  /* Status indicator colors */
  --status-passed: #4ade80;              /* green-400 */
  --status-failed: #f87171;              /* red-400 */
  --status-pending: #facc15;             /* yellow-400 */

  /* Alert: Info (blue) */
  --alert-info-bg: rgba(59, 130, 246, 0.1);
  --alert-info-border: rgba(59, 130, 246, 0.5);
  --alert-info-icon: #60a5fa;              /* blue-400 */
  --alert-info-title: #93c5fd;             /* blue-300 */
  --alert-info-text: #bfdbfe;              /* blue-200 */

  /* Alert: Success (green) */
  --alert-success-bg: rgba(34, 197, 94, 0.1);
  --alert-success-border: rgba(34, 197, 94, 0.5);
  --alert-success-icon: #4ade80;           /* green-400 */
  --alert-success-title: #86efac;          /* green-300 */
  --alert-success-text: #bbf7d0;           /* green-200 */

  /* Alert: Warning (amber) */
  --alert-warning-bg: rgba(245, 158, 11, 0.1);
  --alert-warning-border: rgba(245, 158, 11, 0.5);
  --alert-warning-icon: #fbbf24;           /* amber-400 */
  --alert-warning-title: #fcd34d;          /* amber-300 */
  --alert-warning-text: #fde68a;           /* amber-200 */

  /* Alert: Purple */
  --alert-purple-bg: rgba(168, 85, 247, 0.1);
  --alert-purple-border: rgba(168, 85, 247, 0.5);
  --alert-purple-icon: #c084fc;            /* purple-400 */
  --alert-purple-title: #d8b4fe;           /* purple-300 */
  --alert-purple-text: #e9d5ff;            /* purple-200 */

  /* Alert: Danger (red) */
  --alert-danger-bg: rgba(239, 68, 68, 0.1);
  --alert-danger-border: rgba(239, 68, 68, 0.5);
  --alert-danger-icon: #f87171;            /* red-400 */
  --alert-danger-title: #fca5a5;           /* red-300 */
  --alert-danger-text: #fecaca;            /* red-200 */
}

/* High-contrast theme (#84) */
.high-contrast {
  --bg-gradient-from: #000000;
  --bg-gradient-via: #000000;
  --bg-gradient-to: #000000;

  /* Surfaces */
  --surface-bg: #000000;
  --surface-secondary: #111111;
  --surface-hover: #222222;
  --surface-border: #ffffff;
  --surface-modal: #000000;

  /* Text */
  --text-primary: #ffffff;
  --text-secondary: #f0f0f0;
  --text-muted: #cccccc;

  /* Navigation */
  --nav-bg: #000000;
  --nav-border: #ffffff;

  /* Inputs */
  --input-bg: #111111;
  --input-border: #ffffff;

  /* Scrollbar */
  --scrollbar-track: #111111;

  /* Focus ring offset */
  --ring-offset-bg: #000000;

  /* Accent colors – high-contrast on pure black */
  --accent-red: #ff6b6b;
  --accent-green: #69ff69;
  --accent-blue: #6bb5ff;
  --accent-orange: #ffb347;
  --accent-yellow: #ffff00;
  --accent-cyan: #00ffff;
  --accent-purple: #d98fff;

  /* Muted accent backgrounds */
  --accent-green-muted: rgba(105, 255, 105, 0.15);
  --accent-orange-muted: rgba(255, 179, 71, 0.15);

  /* Focus ring */
  --focus-ring: #ffff00;

  /* Toast icon colors */
  --toast-success: #69ff69;
  --toast-error: #ff6b6b;
  --toast-icon-secondary: #ffffff;
  --toast-warning-bg: #ffff00;
  --toast-warning-text: #000000;

  /* Status indicator colors */
  --status-passed: #69ff69;
  --status-failed: #ff6b6b;
  --status-pending: #ffff00;

  /* Alert: Info (blue) */
  --alert-info-bg: rgba(107, 181, 255, 0.15);
  --alert-info-border: #6bb5ff;
  --alert-info-icon: #6bb5ff;
  --alert-info-title: #ffffff;
  --alert-info-text: #f0f0f0;

  /* Alert: Success (green) */
  --alert-success-bg: rgba(105, 255, 105, 0.15);
  --alert-success-border: #69ff69;
  --alert-success-icon: #69ff69;
  --alert-success-title: #ffffff;
  --alert-success-text: #f0f0f0;

  /* Alert: Warning (amber) */
  --alert-warning-bg: rgba(255, 255, 0, 0.15);
  --alert-warning-border: #ffff00;
  --alert-warning-icon: #ffff00;
  --alert-warning-title: #ffffff;
  --alert-warning-text: #f0f0f0;

  /* Alert: Purple */
  --alert-purple-bg: rgba(217, 143, 255, 0.15);
  --alert-purple-border: #d98fff;
  --alert-purple-icon: #d98fff;
  --alert-purple-title: #ffffff;
  --alert-purple-text: #f0f0f0;

  /* Alert: Danger (red) */
  --alert-danger-bg: rgba(255, 107, 107, 0.15);
  --alert-danger-border: #ff6b6b;
  --alert-danger-icon: #ff6b6b;
  --alert-danger-title: #ffffff;
  --alert-danger-text: #f0f0f0;
}

.high-contrast *:focus-visible {
  outline: 3px solid #ffff00 !important;
  outline-offset: 2px;
}

/* Custom scrollbar */
@layer utilities {
  .scrollbar-thin::-webkit-scrollbar {
    width: 8px;
    height: 8px;
  }

  .scrollbar-thin::-webkit-scrollbar-track {
    background-color: var(--scrollbar-track);
  }

  .scrollbar-thin::-webkit-scrollbar-thumb {
    @apply bg-slate-600 rounded-full;
  }

  .scrollbar-thin::-webkit-scrollbar-thumb:hover {
    @apply bg-slate-500;
  }
}

/* ================================================================
   Reusable Component Classes
   Use these instead of repeating long Tailwind class strings inline.
   To update the look of all inputs/cards/buttons, edit here.
   ================================================================ */
@layer components {
  /* --- Form Controls --- */
  .form-input {
    @apply w-full px-4 py-2 bg-theme-input-bg border border-theme-input-border rounded-lg
           text-theme-text-primary focus:outline-none focus:ring-2 focus:ring-red-500;
  }

  .form-input-sm {
    @apply w-full px-3 py-1.5 bg-theme-input-bg border border-theme-input-border rounded
           text-theme-text-primary text-sm focus:outline-none focus:ring-1 focus:ring-red-500;
  }

  .form-checkbox {
    @apply w-4 h-4 text-red-700 dark:text-red-500 bg-theme-input-bg
           border-theme-input-border rounded focus:ring-red-500;
  }

  .form-label {
    @apply block text-sm font-medium text-theme-text-secondary mb-1;
  }

  .form-label-sm {
    @apply block text-xs font-medium text-theme-text-secondary mb-1;
  }

  /* --- Cards & Surfaces --- */
  .card {
    @apply bg-theme-surface backdrop-blur-sm rounded-lg border border-theme-surface-border;
  }

  .card-secondary {
    @apply bg-theme-surface-secondary rounded-lg border border-theme-surface-border;
  }

  /* --- Buttons --- */
  .btn-primary {
    @apply px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700
           focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50;
  }

  .btn-secondary {
    @apply px-4 py-2 bg-theme-surface text-theme-text-primary rounded-lg
           hover:bg-theme-surface-hover border border-theme-surface-border
           focus:outline-none focus:ring-2 focus:ring-red-500 disabled:opacity-50;
  }

  /* --- Standardized Button Sizes (#79) --- */
  .btn-sm {
    @apply px-2.5 py-1.5 text-xs rounded-md;
  }
  .btn-md {
    @apply px-4 py-2 text-sm rounded-lg;
  }
  .btn-lg {
    @apply px-6 py-3 text-base rounded-lg;
  }
  .btn-icon {
    @apply p-2 rounded-lg min-w-[36px] min-h-[36px] inline-flex items-center justify-center;
  }
  .btn-icon-sm {
    @apply p-1.5 rounded-md min-w-[28px] min-h-[28px] inline-flex items-center justify-center;
  }

  /* --- Stat Cards --- */
  .stat-card {
    @apply bg-theme-surface backdrop-blur-sm rounded-lg p-5 border border-theme-surface-border;
  }

  /* --- Alert / Info Boxes --- */
  .alert-info {
    @apply bg-theme-alert-info-bg border border-theme-alert-info-border rounded-lg p-4;
  }
  .alert-success {
    @apply bg-theme-alert-success-bg border border-theme-alert-success-border rounded-lg p-4;
  }
  .alert-warning {
    @apply bg-theme-alert-warning-bg border border-theme-alert-warning-border rounded-lg p-4;
  }
  .alert-purple {
    @apply bg-theme-alert-purple-bg border border-theme-alert-purple-border rounded-lg p-4;
  }
  .alert-danger {
    @apply bg-theme-alert-danger-bg border border-theme-alert-danger-border rounded-lg p-4;
  }

  /* --- Toggle Switch --- */
  /* Standard toggle-switch knob: always a visible light circle */
  .toggle-knob {
    @apply pointer-events-none inline-block transform rounded-full
           bg-white dark:bg-slate-200 shadow ring-0 transition duration-200 ease-in-out;
  }
  .toggle-knob-sm {
    @apply toggle-knob h-4 w-4;
  }
  .toggle-knob-md {
    @apply toggle-knob h-5 w-5;
  }

  /* --- QR Code Container --- */
  /* QR codes require a white background for scanner contrast, regardless of theme */
  .qr-container {
    @apply bg-white p-8 rounded-lg border-4 border-theme-surface-border;
  }

  /* --- Dynamic Color Dot/Badge --- */
  /* For user-selected category colors applied via inline style.
     Add filter: brightness() in dark mode so the dot stays visible. */
  .color-dot {
    @apply rounded-full;
    /* Dark mode: brighten dynamic colors for better visibility */
  }
  .dark .color-dot {
    filter: brightness(1.2);
  }

  /* --- Mobile-Responsive Patterns --- */

  /* Drawer panel — full-width on mobile, capped at 32rem on sm+ */
  .drawer-panel {
    @apply fixed top-0 right-0 h-full w-full flex flex-col shadow-2xl z-50;
    @apply bg-theme-surface border-l border-theme-surface-border;
    max-width: 100%;
  }
  @media (min-width: 640px) {
    .drawer-panel {
      max-width: 32rem; /* ~512px, equivalent to max-w-lg */
    }
  }

  /* Drawer / modal action-button bars — wrap gracefully on small screens */
  .action-bar {
    @apply flex items-center gap-2 flex-wrap;
  }
  @media (max-width: 479px) {
    .action-bar {
      @apply gap-1.5;
    }
    .action-bar .action-label {
      @apply sr-only;
    }
  }

  /* Responsive form grids: 1-col on mobile, multi-col on sm+ */
  .form-grid-2 {
    @apply grid grid-cols-1 gap-3;
  }
  @media (min-width: 640px) {
    .form-grid-2 {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }
  }

  .form-grid-3 {
    @apply grid grid-cols-1 gap-2;
  }
  @media (min-width: 640px) {
    .form-grid-3 {
      grid-template-columns: repeat(3, minmax(0, 1fr));
    }
  }

  /* Horizontally-scrollable tab bar with hidden scrollbar */
  .tab-scroll {
    @apply flex items-center gap-1 border-b border-theme-surface-border;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }
  .tab-scroll::-webkit-scrollbar {
    display: none;
  }
  .tab-scroll > button {
    white-space: nowrap;
    flex-shrink: 0;
  }

  /* Table column visibility tiers */
  .table-col-secondary {
    display: none;
  }
  @media (min-width: 768px) {
    .table-col-secondary {
      display: table-cell;
    }
  }
  .table-col-tertiary {
    display: none;
  }
  @media (min-width: 1024px) {
    .table-col-tertiary {
      display: table-cell;
    }
  }

  /* Mobile-safe modal body — accounts for on-screen keyboard */
  .modal-body {
    @apply max-h-[85vh] overflow-y-auto;
  }
  @media (min-width: 640px) {
    .modal-body {
      max-height: 90vh;
    }
  }
}

/* Smooth scroll behavior — respect reduced motion preference */
@media (prefers-reduced-motion: no-preference) {
  html {
    scroll-behavior: smooth;
  }
}

/* Disable animations for users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Body defaults */
body {
  @apply antialiased;
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  /* Prevent iOS overscroll bounce on body */
  overscroll-behavior: none;
}

/* Native <option> elements render against the OS dropdown background
   (white on most platforms), so force readable dark-on-white colors
   regardless of the page's dark theme. */
option {
  background-color: #fff;
  color: #111;
}

/* Mobile touch optimizations */
@media (max-width: 767px) {
  /* Prevent text size adjustment on orientation change (iOS) */
  html {
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  /* Improve touch responsiveness — remove 300ms tap delay */
  a, button, [role="button"], input, select, textarea {
    touch-action: manipulation;
  }

  /* Prevent horizontal overflow from any uncontained elements */
  main {
    overflow-x: hidden;
  }

  /* Hide scrollbars on mobile tab bars for cleaner look */
  .scrollbar-thin::-webkit-scrollbar {
    height: 0;
    width: 0;
  }
}

/* Focus visible for accessibility (#70) —
   Show focus rings ONLY on keyboard navigation, not mouse clicks */
*:focus:not(:focus-visible) {
  outline: none;
  box-shadow: none;
  --tw-ring-shadow: none;
}

*:focus-visible {
  @apply outline-none ring-2 ring-red-500 ring-offset-2;
  --tw-ring-offset-color: var(--ring-offset-bg);
}

/* Skip to main content link for accessibility */
.skip-to-main {
  @apply absolute -top-96 left-0 z-50 bg-theme-surface text-theme-text-primary px-4 py-2 rounded-br-lg focus:top-0;
}

/* Print styles (#94) */
@media print {
  /* Hide non-content elements */
  nav, aside, .skip-to-main,
  [role="navigation"], [role="banner"],
  button:not([data-print]),
  .no-print {
    display: none !important;
  }

  /* Reset backgrounds for ink savings */
  body, main, .dark {
    background: white !important;
    color: black !important;
  }

  /* Remove decorative styles */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* Ensure content fits page */
  body {
    font-size: 12pt;
    line-height: 1.5;
  }

  /* Show link URLs */
  a[href]:after {
    content: " (" attr(href) ")";
    font-size: 0.8em;
    color: #666;
  }

  a[href^="#"]:after,
  a[href^="javascript"]:after {
    content: "";
  }

  /* Prevent page breaks inside cards/tables */
  tr, .card, article {
    page-break-inside: avoid;
  }

  /* Ensure images fit */
  img {
    max-width: 100% !important;
  }

  /* ── Member ID Card print layout ── */
  .id-card-printable {
    width: 3.375in !important;   /* CR-80 card width */
    max-width: 3.375in !important;
    margin: 0 auto !important;
    page-break-inside: avoid;
  }

  .id-card-printable * {
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    color-adjust: exact !important;
  }

  /* Suppress the link-URL-after-text rule inside the card */
  .id-card-printable a[href]:after {
    content: "" !important;
  }
}
